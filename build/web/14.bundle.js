(window.webpackJsonp=window.webpackJsonp||[]).push([[14,31],{234:function(e,t,a){"use strict";a.d(t,"b",function(){return n}),a.d(t,"a",function(){return r});var n=[{key:"ru",lang:"ru_RU",name:"RU",title:"Русский"},{key:"en",lang:"en_US",name:"EN",title:"Английский"}],r=n[0]},377:function(e,t,a){e.exports={ImageModal:"ImageModal___t6eXG",ImageModal__title:"ImageModal__title___3sDze",ImageModal__content:"ImageModal__content___2kic5",ImageModal__dropAreaWrapper:"ImageModal__dropAreaWrapper___3HAv9",ImageModal__dropArea:"ImageModal__dropArea___2h12I",ImageModal__buttons:"ImageModal__buttons___3Mdf7",ImageModal__previewContainer:"ImageModal__previewContainer___2JtMF",ImageModal__previewImage:"ImageModal__previewImage___JwEgn",ImageModal__previewImage_spinner:"ImageModal__previewImage_spinner___3wZvx",ImageModal__previewCroppingImage:"ImageModal__previewCroppingImage___3rT5Y"}},408:function(e,t,a){"use strict";a.d(t,"a",function(){return n}),a.d(t,"b",function(){return r});var n="GET_PROPERTIES",r="UPDATE_PROPERTIES"},415:function(e,t,a){"use strict";a.d(t,"a",function(){return l}),a.d(t,"b",function(){return c});var n=a(236),r=a.n(n).a.create({baseURL:window.location.origin}),o="properties";function l(){return r.get("/api/"+o)}function c(e){return r.put("/api/"+o,e)}},433:function(e,t,a){e.exports={ImagesPreview:"ImagesPreview___18FeE",ImagesPreview__item:"ImagesPreview__item___IKTo8",ImagesPreview_tableValue:"ImagesPreview_tableValue___3LyC6",ImageGallery:"ImageGallery___1vHzD",Item:"Item___2vdzm",Item__image:"Item__image___FpQpj",Item__toolbar:"Item__toolbar___15Fcp",Item__btn:"Item__btn___eWMTC",SingleImage__uploadBtn:"SingleImage__uploadBtn___1YddE",SingleImage__uploadBtn_section:"SingleImage__uploadBtn_section___3cewP"}},434:function(e,t,a){e.exports={LocaleTabsRenderer:"LocaleTabsRenderer___lco9i",Nav:"Nav___2pk0r",Nav__item:"Nav__item___15vPX",Nav__link:"Nav__link___31lg5",Nav__link_active:"Nav__link_active___1TORx",Tabs:"Tabs___3v_gg",Tabs__tab:"Tabs__tab___2tF13",Tabs__tab_active:"Tabs__tab_active___3_kms"}},438:function(e,t,a){"use strict";var n=a(0),r=a(43),o=a(234),l=function(e,t){return t&&r.isObject(e)?e[t.key]||e[o.a.key]||"":e||""},c=function(e){var t=e.value,a=e.isEditMode,r=e.changeValue,c=e.locale,i=e.notLocalized;console.log(i,t,c.key);var s=l(t,i?void 0:c);return!a||i&&o.a.key!==c.key?s:n.createElement("input",{type:"text",value:s,onChange:function(e){r(e.target.value,i?void 0:c)},className:"input"})},i=a(67),s=a.n(i),u=a(433),_=a(751),m=(a(398),a(236)),p="/api/cloudinary",d=a.n(m).a.create({baseURL:window.location.origin});a(399);var g,v=a(377),f=(a(123),a(484)),b=a.n(f),E=a(69),I=function(){return(I=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},y=function(e){var t=e.aspectRatio,a=e.initWidth,r=void 0===a?50:a,o=e.src,l=e.ChangePreviewButtonRenderer,c=e.changeUploadingImageStatus,i=e.saveImageInCloudinary,s=e.toggleModal,u=e.isUploadingImage,_=Object(n.useState)({aspect:t,width:r,x:0,y:0}),m=_[0],p=_[1];Object(n.useEffect)(function(){return p(I({},m,{aspect:t}))},[t]);var d=Object(n.useState)(null),g=d[0],f=d[1],y=b.a;return n.createElement(n.Fragment,null,o&&n.createElement("div",{className:v.ImageModal__previewCroppingImage},n.createElement(y,{src:o,crop:m,onChange:function(e){p(I({},m,e))},onComplete:function(e,t){f(t)},keepSelection:!0,imageStyle:{width:"100%",maxHeight:"none"},className:v.ImageModal__previewContainer}),u&&n.createElement(E.a,{className:v.ImageModal__previewImage_spinner})),n.createElement("div",{className:v.ImageModal__buttons},o&&n.createElement(n.Fragment,null,n.createElement(l,{disabled:u}),n.createElement("button",{className:"button",onClick:function(){c(!0);var e=document.createElement("canvas"),t=document.createElement("img");t.src=o;var a=t.height,n=t.width;e.width=g.width*n/100,e.height=g.height*a/100,e.getContext("2d").drawImage(t,g.x*n/100,g.y*a/100,g.width*n/100,g.height*a/100,0,0,g.width*n/100,g.height*a/100),e.toBlob(function(e){e.name="crop.img",e.lastModifiedDate=new Date,i(e)},"image/jpeg")},disabled:u},"Сохранить")),n.createElement("button",{onClick:s,className:"button",disabled:u},"Отменить")))},h=function(e,t,a,n){return new(a||(a=Promise))(function(r,o){function l(e){try{i(n.next(e))}catch(e){o(e)}}function c(e){try{i(n.throw(e))}catch(e){o(e)}}function i(e){e.done?r(e.value):new a(function(t){t(e.value)}).then(l,c)}i((n=n.apply(e,t||[])).next())})},N=function(e,t){var a,n,r,o,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,n=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(r=(r=l.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){l.label=o[1];break}if(6===o[0]&&l.label<r[1]){l.label=r[1],r=o;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(o);break}r[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(e){o=[6,e],n=0}finally{a=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},w=function(e){var t=e.src,a=e.ChangePreviewButtonRenderer,r=e.toggleModal,o=e.saveImageInCloudinary,l=e.isUploadingImage;return n.createElement(n.Fragment,null,t&&n.createElement("div",{className:v.ImageModal__previewImage,style:{backgroundImage:"url("+t+")"}},l&&n.createElement(E.a,{className:v.ImageModal__previewImage_spinner})),n.createElement("div",{className:v.ImageModal__buttons},t&&n.createElement(n.Fragment,null,n.createElement(a,{disabled:l}),n.createElement("button",{className:"button",onClick:function(){var e;(e=t,h(void 0,void 0,void 0,function(){return N(this,function(t){switch(t.label){case 0:return[4,fetch(e)];case 1:return[4,t.sent().blob()];case 2:return[2,t.sent()]}})})).then(function(e){return o(e)})},disabled:l},"Сохранить")),n.createElement("button",{onClick:r,className:"button",disabled:l},"Отменить")))},k=function(e){var t=e.toggleModal,a=e.saveImage,r=e.isOpen,o=e.properties,l=Object(n.useState)(null),c=l[0],i=l[1],u=Object(n.useState)(!1),m=u[0],g=u[1],f=o&&o.aspectRatio,b=function(e){var t=new FileReader;t.onload=function(){return i(t.result)};var a=e.target.files;t.readAsDataURL(a[0])},E=function(e,t){return n.createElement("div",{className:s()("inputFileBtn",{inputFileBtn_disabled:t})},n.createElement("input",{type:"file",onChange:b}),e)},I=function(){!0===r&&(i(null),g(!1)),t()},h=function(e){g(!0);var t,n=new FormData;n.append("0",e),(t=n,d.post(p+"/image-upload",t)).then(function(e){a(e.data[0].url),g(!0),I()}).catch(function(e){g(!0)})},N=function(e){return E("Изменить изображение",e.disabled)};return n.createElement(_.a,{isOpen:r,size:"lg",toggle:t,onClosed:function(){},className:v.ImageModal},n.createElement("div",{className:v.ImageModal__title},"Редактирование изображения"),n.createElement("div",{className:v.ImageModal__content},!c&&n.createElement("div",{className:v.ImageModal__dropAreaWrapper},n.createElement("div",{className:v.ImageModal__dropArea},E("Выбрать изображение"))),f?n.createElement(y,{src:c,aspectRatio:f,initWidth:50,toggleModal:I,changeUploadingImageStatus:g,ChangePreviewButtonRenderer:N,saveImageInCloudinary:h,isUploadingImage:m}):n.createElement(w,{src:c,ChangePreviewButtonRenderer:N,toggleModal:I,saveImageInCloudinary:h,isUploadingImage:m})))},O=function(e){var t=e.toggleModal,a=e.isOpen,r=e.srcImage;return n.createElement(_.a,{isOpen:a,size:"lg",toggle:t},n.createElement("div",{className:v.ImageModal__title},"Просмотр изображения"),n.createElement("div",{className:v.ImageModal__content},n.createElement("div",{className:v.ImageModal__previewImage,style:{backgroundImage:"url("+r+")"}}),n.createElement("div",{className:v.ImageModal__buttons},n.createElement("button",{className:"button",onClick:function(){return t()}},"Закрыть"))))},M=function(e){var t=e.value,a=e.locale,l=e.isEditMode,c=e.changeValue,i=e.notLocalized,_=e.isSingleImage,m=e.properties,p=e.isTableValue,d=Object(n.useState)(!1),g=d[0],v=d[1],f=Object(n.useState)(!1),b=f[0],E=f[1],I=Object(n.useState)(""),y=I[0],h=I[1],N=i?void 0:a,w=function(e,t){return t&&r.isObject(e)?e[t.key]||e[o.a.key]||[]:e||[]}(t,N);m&&m.aspectRatio;return!l||i&&o.a.key!==a.key?function(){var e;return 0===w.length?n.createElement("div",null,"Изображение не задано"):n.createElement("div",{className:s()(u.ImagesPreview,(e={},e[u.ImagesPreview_tableValue]=p,e))},w.map(function(e,t){return n.createElement("div",{className:u.ImagesPreview__item,key:t,onClick:function(){h(e),E(!0)},style:{backgroundImage:"url("+e+")"}})}),n.createElement(O,{isOpen:b,toggleModal:function(){return E(!b)},srcImage:y}))}():function(){var e;return n.createElement("div",{className:u.ImageGallery},w.map(function(e,t){return n.createElement("div",{className:u.Item},n.createElement("div",{className:u.Item__image,style:{backgroundImage:"url("+e+")"}}),n.createElement("div",{className:u.Item__toolbar},n.createElement("button",{className:u.Item__btn,onClick:function(){h(e),E(!0)}},"Просмотр"),n.createElement("button",{className:u.Item__btn,onClick:function(){var e;e=t,c(w.filter(function(t,a){return a!==e}),N)}},"Удалить")))}),(!_||_&&0===w.length)&&n.createElement("button",{className:s()(u.SingleImage__uploadBtn,(e={},e[u.SingleImage__uploadBtn_section]=0!==w.length,e)),onClick:function(){return v(!g)}},"Загрузить изображение"),n.createElement(k,{isOpen:g,properties:m,toggleModal:function(){return v(!g)},saveImage:(m&&m.aspectRatio,function(e){c(w.concat(e),N)})}),n.createElement(O,{isOpen:b,toggleModal:function(){return E(!b)},srcImage:y}))}()},P=a(485),j=a(499),C=(g=function(e,t){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)});P.baseURL="/sources/tinymce";var T=function(e){function t(t){var a=e.call(this,t)||this;return a.onChange=function(e){a.props.onChange(e.target.getContent())},a.state={content:t.value},a}return C(t,e),t.prototype.render=function(){return n.createElement("div",null,n.createElement(j.a,{value:this.state.content,init:{menubar:!1,branding:!1,statusbar:!1,removeformat:[{selector:"*",remove:"all"}]},plugins:"table textcolor colorpicker link anchor paste",toolbar:"undo redo | removeformat | bold italic underline strikethrough | subscript superscript | table  quicklink blockquote |  forecolor backcolor forecolorpicker | link anchor |  alignleft alignright aligncenter alignjustify | bullist numlist | fullscreen preview",onChange:this.onChange}))},t}(n.Component),S=function(e){var t=e.value,a=e.isEditMode,r=e.changeValue,o=e.locale,c=l(t,o);return a?n.createElement(T,{value:c,onChange:function(e){return r(e,o)}}):n.createElement("div",{dangerouslySetInnerHTML:{__html:c}})},R=function(e){var t=e.value,a=e.isEditMode,r=e.changeValue,o=l(t);return a?n.createElement("input",{type:"date",value:o,onChange:function(e){r(e.target.value)},className:"input"}):o},x=function(){return(x=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},G=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(a[n[r]]=e[n[r]])}return a};t.a=function(e){var t=e.type,a=G(e,["type"]);switch(t){case"DATE":return n.createElement(R,x({},a));case"INPUT":return n.createElement(c,x({},a));case"IMAGE":return n.createElement(M,x({},a,{isSingleImage:!0}));case"TEXTAREA":return n.createElement(S,x({},a));case"IMAGE_GALLERY":return n.createElement(M,x({},a));default:throw Error("Invalid header type "+t)}}},440:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(5),l=a(21),c=a(8),i=a.n(c),s=a(67),u=a.n(s),_=a(240),m={tabs:i.a.bool,pills:i.a.bool,vertical:i.a.oneOfType([i.a.bool,i.a.string]),horizontal:i.a.string,justified:i.a.bool,fill:i.a.bool,navbar:i.a.bool,card:i.a.bool,tag:_.k,className:i.a.string,cssModule:i.a.object},p=function(e){var t=e.className,a=e.cssModule,n=e.tabs,c=e.pills,i=e.vertical,s=e.horizontal,m=e.justified,p=e.fill,d=e.navbar,g=e.card,v=e.tag,f=Object(l.a)(e,["className","cssModule","tabs","pills","vertical","horizontal","justified","fill","navbar","card","tag"]),b=Object(_.g)(u()(t,d?"navbar-nav":"nav",!!s&&"justify-content-"+s,function(e){return!1!==e&&(!0===e||"xs"===e?"flex-column":"flex-"+e+"-column")}(i),{"nav-tabs":n,"card-header-tabs":g&&n,"nav-pills":c,"card-header-pills":g&&c,"nav-justified":m,"nav-fill":p}),a);return r.a.createElement(v,Object(o.a)({},f,{className:b}))};p.propTypes=m,p.defaultProps={tag:"ul",vertical:!1};var d=p,g={tag:_.k,active:i.a.bool,className:i.a.string,cssModule:i.a.object},v=function(e){var t=e.className,a=e.cssModule,n=e.active,c=e.tag,i=Object(l.a)(e,["className","cssModule","active","tag"]),s=Object(_.g)(u()(t,"nav-item",!!n&&"active"),a);return r.a.createElement(c,Object(o.a)({},i,{className:s}))};v.propTypes=g,v.defaultProps={tag:"li"};var f=v,b=a(14),E=a(401),I=r.a.createContext({}),y={tag:_.k,activeTab:i.a.any,className:i.a.string,cssModule:i.a.object},h=function(e){function t(t){var a;return(a=e.call(this,t)||this).state={activeTab:a.props.activeTab},a}return Object(b.a)(t,e),t.getDerivedStateFromProps=function(e,t){return t.activeTab!==e.activeTab?{activeTab:e.activeTab}:null},t.prototype.render=function(){var e=this.props,t=e.className,a=e.cssModule,n=e.tag,l=Object(_.h)(this.props,Object.keys(y)),c=Object(_.g)(u()("tab-content",t),a);return r.a.createElement(I.Provider,{value:{activeTabId:this.state.activeTab}},r.a.createElement(n,Object(o.a)({},l,{className:c})))},t}(n.Component);Object(E.polyfill)(h);var N=h;h.propTypes=y,h.defaultProps={tag:"div"};var w={tag:_.k,className:i.a.string,cssModule:i.a.object,tabId:i.a.any};function k(e){var t=e.className,a=e.cssModule,n=e.tabId,c=e.tag,i=Object(l.a)(e,["className","cssModule","tabId","tag"]),s=function(e){return Object(_.g)(u()("tab-pane",t,{active:n===e}),a)};return r.a.createElement(I.Consumer,null,function(e){var t=e.activeTabId;return r.a.createElement(c,Object(o.a)({},i,{className:s(t)}))})}k.propTypes=w,k.defaultProps={tag:"div"};var O=a(434);t.a=function(e){var t=e.locales,a=e.renderLocaleTab;if(1===t.length)return a(t[0]);var r=Object(n.useState)(t[0].key),o=r[0],l=r[1];return n.createElement("div",{className:O.LocaleTabsRenderer},n.createElement(d,{tabs:!0,className:O.Nav},t.map(function(e){var t;return n.createElement(f,{key:e.key,className:O.Nav__item},n.createElement("a",{onClick:function(){return l(e.key)},className:u()(O.Nav__link,(t={},t[O.Nav__link_active]=o===e.key,t))},e.title))})),n.createElement(N,{activeTab:o,className:O.Tabs},t.map(function(e){var t;return n.createElement(k,{tabId:e.key,key:e.key,className:u()(O.Tabs__tab,(t={},t[O.Tabs__tab_active]=o===e.key,t))},a(e))})))}},502:function(e,t,a){"use strict";a.r(t);var n=a(15),r=a(18),o=a(408),l=function(e,t){return t.payload},c=function(e,t){return t.payload},i=function(e,t){if(void 0===e&&(e=[]),t.type===o.a)switch(t.status){case r.a.SUCCEEDED:return l(e,t);default:return e}if(t.type===o.b)switch(t.status){case r.a.SUCCEEDED:return c(e,t);default:return e}return e},s=a(407);a.d(t,"getProperties",function(){return _});var u=Object(n.combineReducers)({properties:i}),_=(t.default=u,function(e){return function(e){return e}(e[s.a].properties)})},691:function(e,t,a){e.exports={Properties:"Properties___1UT27",Properties__toolbar:"Properties__toolbar___g6zhE",Group:"Group___ccR1h",Group__title:"Group__title___OZ98S",Group__content:"Group__content___2vkqK",Property:"Property___1SMQQ",Property__title:"Property__title___1cGod",Property_asGroup:"Property_asGroup___2XRX_",Property__content:"Property__content___2W9-p"}},752:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(43),o=a(67),l=a.n(o),c=a(438),i=a(691),s=a(234),u=function(){return(u=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},_=function(e){var t=e.properties,a=e.locale,o=e.updateProperties,_=Object(n.useState)(!1),m=_[0],p=_[1],d=Object(n.useState)(t),g=d[0],v=d[1];Object(n.useEffect)(function(){v(t)},[t]);var f=g.reduce(function(e,t){var a,n=t.group||t.name;return u({},e,((a={})[n]=(e[n]||[]).concat(t),a))},{});console.log(f);var b=n.createElement(n.Fragment,null,!m&&n.createElement("button",{className:"button",onClick:function(){return p(!0)}},"Редактировать"),m&&n.createElement("button",{className:"button",onClick:function(){return p(!1)}},"Назад без сохранения"),m&&n.createElement("button",{className:"button",onClick:function(){o(g),p(!1)}},"Сохранить изменения"));return n.createElement("div",{className:i.Properties},n.createElement("div",{className:i.Properties__toolbar},b),Object.keys(f).map(function(e){var t=f[e];return n.createElement("div",{className:i.Group,key:e},t.length>1&&n.createElement("div",{className:i.Group__title},t[0].titleGroup),n.createElement("div",{className:i.Group__content},t.map(function(e){var o,_;return n.createElement("div",{className:l()(i.Property,(o={},o[i.Property_asGroup]=1===t.length,o)),key:e._id},n.createElement("div",{className:i.Property__title},e.name),n.createElement("div",{className:i.Property__content},n.createElement(c.a,{type:e.type,value:e.value,notLocalized:e.notLocalized,isEditMode:m,changeValue:(_=e._id,function(e,t){var a=g.map(function(a){var n;if(a._id!==_)return a;var o=t?r.isObject(a.value)?u({},a.value,((n={})[t.key]=e,n)):s.b.reduce(function(t,a){var n;return u({},t,((n={})[a.key]=e,n))},{}):e;return u({},a,{value:o})});console.log(a),v(a)}),locale:a})))})))}),n.createElement("div",{className:i.Properties__toolbar},b))},m=a(33),p=a(502),d=a(415),g=a(18),v=a(408),f=a(407);var b=a(440);t.default=Object(m.b)(function(e){return{properties:p.getProperties(e)}},function(e){return{getProperties:function(){return e(Object(g.b)(v.a,d.a().then(function(e){return e.data}),{moduleName:f.a}))},updateProperties:function(t){return e(function(e){return Object(g.b)(v.b,d.b(e).then(function(e){return e.data}),{moduleName:f.a})}(t))}}})(function(e){var t=e.properties,a=e.getProperties,r=e.updateProperties;return Object(n.useEffect)(function(){a()},[]),n.createElement(b.a,{locales:s.b,renderLocaleTab:function(e){return n.createElement(_,{properties:t,locale:e,updateProperties:r})}})})}}]);
//# sourceMappingURL=14.bundle.js.map